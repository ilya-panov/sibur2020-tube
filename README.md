# Sibur-2020 Challenge: Труба

Цель [соревнования](https://sc2020.ai-community.com/) - прогнозирование состава газовой смеси, проходящей по трубе: на вход даны замеры состава смеси в точке А, необходимо спрогнозиовать состав в точке Б. Главное условие - не заглядывать в будущее, т.е. при прогнозировании состава газа, который был в точке А во время Т нельзя использовать данные Т+1.

## Идея решения

Для решения необходима модель регрессии. Казалось бы достаточно взять из `SkLearn` модель, строящую регрессиию и решение готово. Но условие "не заглядывать в будущее" усложняет подбор свойств для модели. Вместе с тем, если заглянуть в будущее, то самая простая LinearRegression даёт неплохой результат.

Если нельзя, но очень хочется, то будем имитировать заглядывание в будущее. Имитацию будет выполнять предсказание временного ряда на основе авторегрессии с помощью модели `AR` из библиотеки `statsmodels`.

Например, в ходе экспериментов для газа iC4H10 было установлено, что модель линейной регрессии даёт хороший результат, если в качестве вектора фич взять показания 300 точек замера до времени Т и 300 точек после времени Т, т.е. из будущего. Для предсказания данных из будущего используется модель авторегресии.

```python
model = AR(df['A_iC4H10'])
ARfit = model.fit(method='mle')

forecast_start = len(df)
forecast_end = forecast_start + 300

fcasts = ARfit.predict(start=forecast_start, end=forecast_end, dynamic=False)
```

## Решение

Обучение моделей содержится в [ноутбуке обучения](notebooks/train_predict.ipynb). 

Процедура предсказания состава газа, включающая предсказание поведения временного ряда в будущем, содержится в [ноутбуке предсказания](notebooks/predict-1.0.0.ipynb).

Качество итогового предсказания во многом определилось качеством модели авторегрессии временного ряда, и в итоге средняя по всем целевым переменным получилась **4.99**.